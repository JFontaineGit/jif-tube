@use '../../../styles/_variables.scss' as var;
@use '../../../styles/_mixins.scss' as mix;
@use '../../../styles/_media-queries.scss' as media;

.search-page {
  padding: var.$spacing-3xl var.$spacing-2xl;
  min-height: calc(100vh - var.$navbar-height);

  @include media.mobile-only {
    padding: var.$spacing-xl var.$spacing-md;
  }

  .page-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var.$spacing-xl;
    margin-bottom: var.$spacing-2xl;

    @include media.mobile-only {
      gap: var.$spacing-lg;
      margin-bottom: var.$spacing-xl;
    }

    .header-content {
      display: flex;
      flex-direction: column;
      gap: var.$spacing-xs;
    }

    .page-title {
      font-size: var.$font-size-2xl;
      font-weight: var.$font-weight-bold;
      color: var.$text-primary;
      margin: 0;

      @include media.mobile-only {
        font-size: var.$font-size-xl;
      }
    }

    .page-subtitle {
      font-size: var.$font-size-sm;
      color: var.$text-secondary;

      @include media.mobile-only {
        font-size: var.$font-size-xs;
      }
    }

    .reload-btn {
      width: 46px;
      height: 46px;
      border-radius: var.$radius-full;
      border: 1px solid color-mix(in srgb, var(--ytmusic-album-color, var.$dynamic-primary) 50%, transparent);
      background: color-mix(
        in srgb,
        rgba(var(--ytmusic-album-color, 32, 32, 32), 0.85) 65%,
        rgba(0, 0, 0, 0.75) 35%
      );
      color: var.$text-primary;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var.$transition-fast;
      backdrop-filter: var.$blur-sm;
      -webkit-backdrop-filter: var.$blur-sm;

      @include mix.focus-ring(var(--ytmusic-album-color, var.$dynamic-primary));

      @include media.mobile-only {
        width: 42px;
        height: 42px;
      }

      &:hover:not(:disabled) {
        transform: translateY(-1px) scale(1.05);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.35);
        border-color: color-mix(in srgb, var(--ytmusic-album-color, var.$dynamic-primary) 70%, transparent);
      }

      &:active:not(:disabled) {
        transform: scale(0.94);
      }

      &:disabled {
        cursor: wait;
        opacity: 0.6;
        transform: none;
      }

      .material-icons {
        font-size: var.$font-size-lg;
        transition: transform var.$transition-fast;

        &.spinning {
          animation: spin 1s linear infinite;
        }
      }
    }
  }

  // ========================================
  // MEJOR RESULTADO (Destacado tipo YT Music)
  // ========================================
  .best-result {
    margin-bottom: var.$spacing-3xl;
    
    @include media.mobile-only {
      margin-bottom: var.$spacing-2xl;
    }

    app-song-card {
      display: block;
      background: color-mix(
        in srgb,
        rgba(var(--ytmusic-album-color, 30, 30, 30), 0.72) 65%,
        rgba(6, 6, 6, 0.86) 35%
      );
      border: 1px solid color-mix(
        in srgb,
        rgba(var(--ytmusic-album-color, 255, 255, 255), 0.25) 55%,
        rgba(255, 255, 255, 0.1) 45%
      );
      border-radius: var.$radius-2xl;
      padding: var.$spacing-2xl;
      transition: all var.$transition-normal;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);

      @include media.mobile-only {
        padding: var.$spacing-lg;
        border-radius: var.$radius-xl;
      }

      // Efecto de brillo sutil en el fondo
      &::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          135deg,
          color-mix(in srgb, rgba(var(--ytmusic-album-color, 255, 255, 255), 0.25) 40%, transparent) 0%,
          transparent 55%
        );
        pointer-events: none;
        opacity: 0;
        transition: opacity var.$transition-normal;
      }

      &:hover {
        transform: translateY(-4px);
        border-color: color-mix(
          in srgb,
          rgba(var(--ytmusic-album-color, 255, 255, 255), 0.35) 60%,
          rgba(255, 255, 255, 0.15) 40%
        );
        box-shadow: 0 18px 48px rgba(0, 0, 0, 0.45);

        &::before {
          opacity: 1;
        }
      }

      &:active {
        transform: translateY(-2px);
      }
    }
  }

  // ========================================
  // SECCIÃ“N DE CANCIONES
  // ========================================
  .section-title {
    font-size: var.$font-size-xl;
    font-weight: var.$font-weight-bold;
    color: var.$text-primary;
    margin-bottom: var.$spacing-lg;

    @include media.mobile-only {
      font-size: var.$font-size-lg;
      margin-bottom: var.$spacing-md;
    }
  }

  .song-list {
    display: grid;
    gap: var.$spacing-xl;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    
    @include media.mobile-only {
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: var.$spacing-lg;
    }

    @media (min-width: 1024px) {
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }

    @media (min-width: 1280px) {
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    }
  }
}

// ========================================
// ESTADOS DE CARGA Y ERROR
// ========================================
.search-page {
  .loading-state,
  .error-state,
  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var.$spacing-4xl;
    text-align: center;
    color: var.$text-secondary;

    @include media.mobile-only {
      padding: var.$spacing-3xl var.$spacing-lg;
    }
  }
}

@keyframes spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

// ========================================
// ACCESIBILIDAD Y MOTION
// ========================================
@include media.reduce-motion {
  .search-page {
    .best-result app-song-card,
    .reload-btn {
      transition: none !important;
      animation: none !important;
    }

    .best-result app-song-card:hover {
      transform: none;
    }
  }
}

@include media.high-contrast {
  .search-page {
    .best-result app-song-card {
      border: 2px solid #ffffff;
      background: #000000;
    }
  }
}