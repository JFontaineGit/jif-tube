@use 'sass:color';
@use '../../../styles/_variables.scss' as var;
@use '../../../styles/_mixins.scss' as mix;
@use '../../../styles/_media-queries.scss' as media;

.auth-dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.75);
  backdrop-filter: var.$blur-lg;
  z-index: var.$z-modal;
  animation: fadeIn 0.3s ease-out;

  @include mix.flex-center;
}

.auth-dialog {
  min-width: 450px;
  max-width: 500px;
  max-height: 85vh;
  overflow-y: auto;
  background: linear-gradient(135deg, rgba(26, 26, 26, 0.98) 0%, rgba(10, 10, 10, 0.98) 100%);
  border: 1px solid var.$border-color;
  border-radius: var.$radius-2xl;
  box-shadow: var.$shadow-glass;
  position: relative;
  animation: slideInUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);

  @include media.mobile-only {
    min-width: auto;
    width: 92vw;
    max-width: none;
    margin: var.$spacing-lg;
  }

  @include mix.custom-scrollbar;
  @include mix.glassmorphism(0.05);

  &__header {
    padding: var.$spacing-3xl var.$spacing-3xl var.$spacing-xl;
    text-align: center;
    border-bottom: 1px solid var.$border-color-light;
  }

  &__icon {
    margin-bottom: var.$spacing-xl;

    svg {
      stroke: var.$dynamic-primary;
      filter: drop-shadow(0 0 8px rgba(59, 130, 246, 0.4));
    }
  }

  h2 {
    margin: 0 0 var.$spacing-md 0;
    font-size: var.$font-size-2xl;
    font-weight: var.$font-weight-extrabold;
    color: var.$text-primary;
    letter-spacing: -0.025em;

    @include mix.gradient-text(var.$primary-blue, var.$primary-purple);
  }

  p {
    margin: 0;
    font-size: var.$font-size-sm;
    color: var.$text-secondary;
    line-height: var.$line-height-relaxed;
  }

  &__form {
    padding: var.$spacing-2xl var.$spacing-3xl;
  }

  &__message {
    margin: var.$spacing-lg var.$spacing-3xl 0;
    padding: var.$spacing-md var.$spacing-lg;
    border-radius: var.$radius-lg;
    font-size: var.$font-size-sm;
    font-weight: var.$font-weight-medium;
    text-align: center;
    animation: slideDown 0.3s ease-out;

    &--error {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #fca5a5;
    }

    &--success {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      color: #6ee7b7;
    }
  }

  &__submit {
    width: 100%;
    padding: var.$spacing-lg var.$spacing-xl;
    background: linear-gradient(135deg, var.$primary-blue, var.$primary-purple);
    color: var.$text-primary;
    font-size: var.$font-size-base;
    font-weight: var.$font-weight-semibold;
    border-radius: var.$radius-xl;
    transition: all var.$transition-normal;
    margin-top: var.$spacing-2xl;

    @include mix.button-base;
    @include mix.flex-center;

    &:hover:not(:disabled) {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 12px 32px rgba(59, 130, 246, 0.3);
    }

    &:active:not(:disabled) {
      transform: translateY(0) scale(1);
    }

    &:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
  }

  &__footer {
    text-align: center;
    margin-top: var.$spacing-xl;
    padding-top: var.$spacing-xl;
    border-top: 1px solid var.$border-color-light;

    p {
      font-size: var.$font-size-sm;
      color: var.$text-secondary;
    }
  }

  &__close {
    position: absolute;
    top: var.$spacing-lg;
    right: var.$spacing-lg;
    width: 36px;
    height: 36px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid var.$border-color-light;
    border-radius: var.$radius-full;
    color: var.$text-secondary;
    cursor: pointer;
    transition: all var.$transition-fast;

    @include mix.flex-center;

    &:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: var.$border-color;
      color: var.$text-primary;
      transform: rotate(90deg) scale(1.1);
    }
  }
}

// =========================================================================
// FORM ELEMENTS
// =========================================================================

.form-group {
  margin-bottom: var.$spacing-xl;
}

.form-group-checkbox {
  margin-bottom: var.$spacing-md;
  
  .checkbox-label {
    display: flex;
    align-items: center;
    gap: var.$spacing-sm;
    cursor: pointer;
    font-size: var.$font-size-sm;
    color: var.$text-secondary;
    user-select: none;
    
    input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var.$primary-blue;
    }
    
    &:hover {
      color: var.$text-primary;
    }
  }
}

.form-label {
  display: block;
  margin-bottom: var.$spacing-sm;
  font-size: var.$font-size-sm;
  font-weight: var.$font-weight-semibold;
  color: var.$text-primary;
  letter-spacing: 0.01em;
}

.form-input {
  width: 100%;
  padding: var.$spacing-md var.$spacing-lg;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var.$border-color;
  border-radius: var.$radius-lg;
  color: var.$text-primary;
  font-size: var.$font-size-base;
  font-family: inherit;
  transition: all var.$transition-normal;

  &::placeholder {
    color: var.$text-muted;
  }

  &:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.08);
    border-color: var.$primary-blue;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  &:hover:not(:focus) {
    border-color: var.$border-color;
  }

  &--error {
    border-color: var.$error;

    &:focus {
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }
  }
}

// =========================================================================
// PASSWORD INPUT
// =========================================================================

.password-input {
  position: relative;

  .form-input {
    padding-right: 48px;
  }

  .toggle-password {
    position: absolute;
    right: var.$spacing-md;
    top: 50%;
    transform: translateY(-50%);
    width: 32px;
    height: 32px;
    background: none;
    border: none;
    color: var.$text-muted;
    cursor: pointer;
    border-radius: var.$radius-md;
    transition: all var.$transition-fast;

    @include mix.flex-center;

    &:hover {
      color: var.$text-secondary;
      background: rgba(255, 255, 255, 0.05);
    }
  }
}

// =========================================================================
// PASSWORD VALIDATION & STRENGTH
// =========================================================================

.password-hint {
  margin-top: var.$spacing-sm;
  font-size: var.$font-size-xs;
  color: var.$text-muted;
  font-style: italic;
  display: flex;
  align-items: center;
  gap: var.$spacing-xs;
  
  &::before {
    content: 'ℹ';
    font-style: normal;
    opacity: 0.6;
  }
}

.password-strength {
  margin-top: var.$spacing-sm;

  @include mix.flex-inline(var.$spacing-sm);

  .strength-bar {
    flex: 1;
    height: 4px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var.$radius-full;
    overflow: hidden;
  }

  .strength-fill {
    height: 100%;
    border-radius: var.$radius-full;
    transition: all var.$transition-normal;

    &.weak {
      background: var.$error;
    }

    &.medium {
      background: var.$warning;
    }

    &.strong {
      background: var.$success;
    }
  }

  .strength-text {
    font-size: var.$font-size-xs;
    font-weight: var.$font-weight-semibold;
    min-width: 50px;
    text-align: right;

    &.weak { color: var.$error; }
    &.medium { color: var.$warning; }
    &.strong { color: var.$success; }
  }
}

.error-message {
  margin-top: var.$spacing-sm;
  font-size: var.$font-size-xs;
  color: #fca5a5;
  font-weight: var.$font-weight-medium;
  display: flex;
  align-items: flex-start;
  gap: var.$spacing-xs;
  line-height: 1.4;
  
  &::before {
    content: '⚠';
    flex-shrink: 0;
    font-size: var.$font-size-sm;
  }
}

// =========================================================================
// BUTTONS & LINKS
// =========================================================================

.forgot-link {
  background: none;
  border: none;
  color: var.$primary-blue;
  font-size: var.$font-size-sm;
  font-weight: var.$font-weight-medium;
  cursor: pointer;
  transition: all var.$transition-fast;
  padding: 0;
  margin-bottom: var.$spacing-md;
  display: inline-block;

  &:hover {
    color: var.$primary-purple;
    text-decoration: underline;
  }
}

.link-button {
  background: none;
  border: none;
  color: var.$primary-blue;
  font-weight: var.$font-weight-semibold;
  cursor: pointer;
  transition: all var.$transition-fast;
  padding: 0;

  &:hover {
    color: var.$primary-purple;
    text-decoration: underline;
  }
}

.loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-top-color: var.$text-primary;
  border-radius: var.$radius-full;
  animation: spin 0.8s linear infinite;
  margin-right: var.$spacing-sm;
}

// =========================================================================
// ANIMATIONS
// =========================================================================

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(40px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

// =========================================================================
// ACCESSIBILITY
// =========================================================================

@include media.reduce-motion {
  .auth-dialog-overlay,
  .auth-dialog,
  .auth-dialog__message,
  .loading-spinner {
    animation: none !important;
    transition: none !important;
    transform: none !important;
  }
}